name: iOS CI

on:
  push:
    paths:
      - "ios/**"
      - "shared/contracts/**"
  pull_request:
    paths:
      - "ios/**"
      - "shared/contracts/**"

jobs:
  build:
    runs-on: macos-latest
    defaults:
      run:
        working-directory: ios
    steps:
      - uses: actions/checkout@v4
      - name: Xcode version
        run: xcodebuild -version
      - name: Build (simulator)
        run: |
          if [ -f "HealthOS.xcodeproj/project.pbxproj" ]; then
            xcodebuild \
              -project HealthOS.xcodeproj \
              -scheme HealthOS \
              -destination 'platform=iOS Simulator,name=iPhone 15' \
              clean build \
              CODE_SIGNING_ALLOWED=NO
          else
            echo "No Xcode project yet. Skipping iOS build."
          fi
